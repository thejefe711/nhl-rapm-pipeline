Limiting to first 1 games for testing.
======================================================================
RAPM suite - mode=stint strength=5v5 metrics=xg
======================================================================
Games: 1
Min TOI: 600s
Alphas: [1000.0, 10000.0, 100000.0]

--- Season 20242025 (1 games) ---
  OK Loaded cached xG model from C:\Users\akork\APM to LLM Web App\nhl_pipeline\models\xg_model_20242025.pkl
  Processing 1 games sequentially...
  ... processed 0/1 games
DEBUG: _predict_xg range: min=0.061189, max=0.793632, avg=0.399491
DEBUG: Period 1 - Goalies: Home={8480045, 8482221}, Away={8474593, 8474596}
DEBUG: Skipped interval 74-78: hcnt=6, acnt=5, s=5v5
DEBUG: Skipped interval 78-84: hcnt=6, acnt=5, s=5v5
DEBUG: Skipped interval 84-85: hcnt=6, acnt=5, s=5v5
DEBUG: Skipped interval 85-88: hcnt=6, acnt=5, s=5v5
DEBUG: Skipped interval 88-93: hcnt=6, acnt=5, s=5v5
DEBUG: Period 2 - Goalies: Home={8480045, 8482221}, Away={8474593, 8474596}
DEBUG: Skipped interval 375-393: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 393-397: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 397-411: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 411-435: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 435-495: hcnt=5, acnt=4, s=5v5
DEBUG: Period 3 - Goalies: Home={8480045, 8482221}, Away={8474593, 8474596}
DEBUG: Skipped interval 343-376: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 376-377: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 377-378: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 378-403: hcnt=5, acnt=4, s=5v5
DEBUG: Skipped interval 403-425: hcnt=5, acnt=4, s=5v5
DEBUG: args.deep_validate=True, DeepValidator=<class 'nhl_pipeline.src.validation.deep_validator.DeepValidator'>
DEBUG: Calling validate_stints...

=== STINT VALIDATION ===
WARN: 'game_id' not in stints DataFrame, skipping per-game checks.

Stint duration (seconds): min=1.0, median=6.0, max=52.0
  Expected: 2-180

Stints with !=5 home skaters: 0 (0.00%)
Stints with !=5 away skaters: 0 (0.00%)
  Expected: 0% (for 5v5 stints)
DEBUG: _ridge_fit used Ridge(solver='lsqr', alpha=100.0)
  Fit [xg_rapm_5v5]: rows=102 players=29 alpha=100
DEBUG: _write_apm_results writing 29 rows for xg_rapm_5v5

OK Saved to DuckDB: C:\Users\akork\APM to LLM Web App\nhl_pipeline\nhl_canonical.duckdb
